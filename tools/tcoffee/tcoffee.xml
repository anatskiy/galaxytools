<tool id="tcoffee" name="T-Coffee" version="0.1">
    <requirements>
        <requirement type="package" version="11.0.8">t_coffee</requirement>
    </requirements>
    <command><![CDATA[
        t_coffee

        -in "$input"
        M"$method1"
        M"$method2"
        M"$method3"

        #if str($out) != ""
            -output
            $out.format_msf_aln
            $out.format_clustalw_aln
            $out.format_pir_aln
            $out.format_fasta_aln
            $out.format_phylip
            $out.format_pir_seq
            $out.format_fasta_seq
            $out.format_score_ascii
            $out.format_score_html
        #end if
]]>
    </command>
    <inputs>
        <param name="input" type="data" format="fasta" label="Source file" />

        <param name="method1" type="select" label="Pairwise Sequence Alignment Method">
            <option value="">Default</option>
            <option value="fast_pair">fast</option>
            <option value="exon3_pair">exon3</option>
            <option value="exon2_pair">exon2</option>
            <option value="exon_pair">exon</option>
            <option value="slow_pair">slow</option>
            <option value="proba_pair">probA</option>
            <option value="lalign_id_pair">lalign id</option>
            <option value="seq_pair">seq</option>
            <option value="externprofile_pair">externprofile</option>
            <option value="hh_pair">hh</option>
            <option value="profile_pair">profile</option>
            <option value="cdna_fast_pair">cdna fast</option>
            <option value="cdna_cfast_pair">cdna cfast</option>
            <option value="clustalw_pair">ClustalW</option>
            <option value="mafft_pair">mafft</option>
            <option value="mafftjtt_pair">mafftjtt</option>
            <option value="mafftgins_pair">mafftgins</option>
            <option value="dialignt_pair">dialign-t</option>
            <option value="poa_pair">poa</option>
            <option value="probcons_pair">ProbCons</option>
            <option value="muscle_pair">Muscle</option>
            <option value="t_coffee_pair">T-Coffee</option>
            <option value="pcma_pair">pcma</option>
            <option value="kalign_pair">kalign</option>
            <option value="amap_pair">amap</option>
            <option value="proda_pair">proda</option>
            <option value="prank_pair">prank</option>
            <option value="consan_pair">consan</option>
        </param>

        <param name="method2" type="select" label="Pairwise Structural Alignment Method">
            <option value="">Default</option>
            <option value="align_pdbpair">align_pdb</option>
            <option value="lalign_pdbpair">lalign_pdb</option>
            <option value="extern_pdbpair">extern_pdb</option>
            <option value="thread_pair">thread</option>
            <option value="fugue_pair">fugue</option>
            <option value="pdb_pair">pdb</option>
            <option value="sap_pair">sap</option>
            <option value="mustang_pair">mustang</option>
            <option value="tmalign_pair">tmalign</option>
        </param>

        <param name="method3" type="select" label="Multiple Sequence Alignment Method">
            <option value="">Default</option>
            <option value="clustalw_msa">ClustalW</option>
            <option value="mafft_msa">mafft</option>
            <option value="mafftjtt_msa">mafftjtt</option>
            <option value="mafftgins_msa">mafftgins</option>
            <option value="dialigntx_msa">dialign-tx</option>
            <option value="dialignt_msa">dialign-t</option>
            <option value="poa_msa">poa</option>
            <option value="probcons_msa">ProbCons</option>
            <option value="muscle_msa">Muscle</option>
            <option value="t_coffee_msa">T-Coffee</option>
            <option value="pcma_msa">pcma</option>
            <option value="kalign_msa">kalign</option>
            <option value="amap_msa">amap</option>
            <option value="proda_msa">proda</option>
            <option value="prank_msa">prank</option>
        </param>

        <section name="out" title="Output Format" expanded="True">
            <!-- <param name="format_dnd" type="boolean" checked="false" truevalue="dnd" falsevalue="" label="Newick" /> -->
            <param name="format_msf_aln" type="boolean" checked="false" truevalue="msf_aln" falsevalue="" label="MSF alignment" />
            <param name="format_clustalw_aln" type="boolean" checked="false" truevalue="clustalw_aln" falsevalue="" label="ClustalW format" />
            <param name="format_pir_aln" type="boolean" checked="false" truevalue="pir_aln" falsevalue="" label="pir alignment" />
            <param name="format_fasta_aln" type="boolean" checked="false" truevalue="fasta_aln" falsevalue="" label="FASTA alignment" />
            <param name="format_phylip" type="boolean" checked="false" truevalue="phylip" falsevalue="" label="Phylip format" />
            <param name="format_pir_seq" type="boolean" checked="false" truevalue="pir_seq" falsevalue="" label="pir sequences (no gap)" />
            <param name="format_fasta_seq" type="boolean" checked="false" truevalue="fasta_seq" falsevalue="" label="FASTA sequences (no gap)" />
            <param name="format_score_ascii" type="boolean" checked="false" truevalue="score_ascii" falsevalue="" label="Score ASCII" />
            <param name="format_score_html" type="boolean" checked="false" truevalue="score_html" falsevalue="" label="Score HTML" />
        </section>
    </inputs>
    <outputs>
        <!-- <data format="nhx" name="dnd" label="${tool.name} on ${on_string}: newick.dnd" >
          <filter>out.format_dnd == "dnd"</filter>
        </data> -->
        <data format="msf" name="msf_aln" label="${tool.name} on ${on_string}: msf_aln" >
          <filter>out.format_msf_aln == "msf_aln"</filter>
        </data>
        <data format="clustalw" name="clustalw_aln" label="${tool.name} on ${on_string}: clustalw_aln" >
          <filter>out.format_clustalw_aln == "clustalw_aln"</filter>
        </data>
        <data format="pir" name="pir_aln" label="${tool.name} on ${on_string}: pir_aln" >
          <filter>out.format_pir_aln == "pir_aln"</filter>
        </data>
        <data format="fasta" name="fasta_aln" label="${tool.name} on ${on_string}: fasta_aln" >
          <filter>out.format_fasta_aln == "fasta_aln"</filter>
        </data>
        <data format="phyloxml" name="phylip" label="${tool.name} on ${on_string}: phylip" >
          <filter>out.format_phylip == "phylip"</filter>
        </data>
        <data format="pir" name="pir_seq" label="${tool.name} on ${on_string}: pir_seq" >
          <filter>out.format_pir_seq == "pir_seq"</filter>
        </data>
        <data format="fasta" name="fasta_seq" label="${tool.name} on ${on_string}: fasta_seq" >
          <filter>out.format_fasta_seq == "fasta_seq"</filter>
        </data>
        <data format="ascii" name="score_ascii" label="${tool.name} on ${on_string}: score_ascii" >
          <filter>out.format_score_ascii == "score_ascii"</filter>
        </data>
        <data format="html" name="score_html" label="${tool.name} on ${on_string}: score_html" >
          <filter>out.format_score_html == "score_html"</filter>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="input" value="tcoffee_in.fasta" ftype= "fasta" />
            <param name="out.format_fasta_aln" value="fasta_aln" />
            <output name="fasta_aln" file="tcoffee_out.fasta" ftype= "fasta" />
        </test>
    </tests>
    <help>
**What is T-Coffee**

`T-Coffee`_ is a multiple sequence alignment package. You can use T-Coffee to align sequences or to combine the output of your favorite alignment methods (Clustal, Mafft, Probcons, Muscle...) into one unique alignment (`M-Coffee`_).

T-Coffee can align Protein, DNA and RNA sequences. It is also able to combine sequence information with protein structural information (`3D-Coffee/Expresso`_), profile information (PSI-Coffee) or RNA secondary structures (`R-Coffee`_).

.. _T-Coffee:           http://www.tcoffee.org/Projects/tcoffee/
.. _M-Coffee:           http://www.tcoffee.org/Projects/mcoffee/index.html
.. _3D-Coffee/Expresso: http://www.tcoffee.org/Projects/expresso/index.html
.. _R-Coffee:           http://www.tcoffee.org/Projects/rcoffee/index.html
    </help>
    <tests>
        <test>
            <param name="input" value="3.fasta" ftype= "fasta"/>
            <param name="format_output_fasta_aln" value="fasta_aln"/>
            <output name="fasta_aln" file="tcoffee_out.fasta" ftype= "fasta"/>
        </test>
    </tests>
    <citations>
        <citation type="bibtex">
            @article{JMB,
                author = {CÃ©dric Notredame, Desmond G. Higgins and Jaap Heringa},
                year = {2000},
                title = {T-Coffee: A Novel Method for Fast and Accurate Multiple Sequence Alignment},
                publisher = {JMB},
                journal = {JMB},
                url = {http://www.tcoffee.org/Publications/Pdf/tcoffee.pdf},
            }
        </citation>
    </citations>
</tool>
